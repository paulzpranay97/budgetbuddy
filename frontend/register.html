<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EXPENSE</title>
	<!-- <script src="https://unpkg.com/boxicons@2.1.3/dist/boxicons.js"></script> -->

    <!-- BOX ICON -->
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <!-- CSS FILE -->
    <link rel="stylesheet" href="./style/register.css" />
	<link rel="stylesheet" href="./style/formdata.css">
</head>

<body>
   
  
	<!-- SIDEBAR -->
	<section id="sidebar">
	  <a href="#" class="brand">
		  <img class="bblogo" src="./images/projectnxm201logo.png" alt="">
		  
	  </a>
	  <ul class="side-menu top">
		  <li class="active">
			  <a href="/public/admin.html">
				  <i class='bx bxs-dashboard' ></i>
				  <span class="text">Dashboard</span>
			  </a>
		  </li>
		  <li>
			  <a href="store.html" >
				  <i class='bx bx-card' ></i>
				  <span class="text">View Transactions</span>
			  </a>
		  </li>
		  <li>
			  <a href="edit.html" >
				  <i class='bx bxs-up-arrow-circle' ></i>
				  <span class="text">Income</span>
			  </a>
		  </li>
		  <li>
			  <a href="register.html">
				  <i class='bx bxs-down-arrow-circle' ></i>
				  <span class="text">Expense</span>
			  </a>
		  </li>
		  
	  </ul>
	  <ul class="side-menu">
		  
		  <li>
			  <a href="./index.html" class="logout">
				  <i class='bx bx-log-out' ></i>
				  <span class="text">Logout</span>
			  </a>
		  </li>
	  </ul>
  </section>
	  <!-- SIDEBAR -->
  
  
  
	  <!-- CONTENT -->
	  <section id="content">
		  <!-- NAVBAR -->
		  <nav>
			  <a href="#" class="profile">
				  <img  id="profile_pic" src="https://th.bing.com/th/id/OIP.y-nGyqT5AwES8oqp344z4gHaHa?pid=ImgDet&rs=1">
			  </a>
			  <a href="#" class="nav-link">NAME</a>
			  <form action="#">
				  <div class="form-input">
					  <input type="search" placeholder="Search...">
					  <button type="submit" class="search-btn"><i class='bx bx-search' ></i></button>
				  </div>
			  </form>
			  <input type="checkbox" id="switch-mode" hidden>
			  <label for="switch-mode" class="switch-mode"></label>
			  <a href="#" class="notification">
				  <i class='bx bxs-bell' ></i>
				  <span class="num">8</span>
			  </a>
			  
		  </nav>
		  <main>
			  <div class="head-title">
				  <div class="left">
					  <h1>Expense</h1>
					  <!-- <ul class="breadcrumb">
						  <li>
							  <a href="#">Dashboard</a>
						  </li>
						  <li><i class='bx bx-chevron-right' ></i></li>
						  <li>
							  <a class="active" href="./index.html" target="_blank">HomePage</a>
						  </li>
					  </ul> -->
				  </div>
				  <a href="#" class="btn-download">
					  <i class='bx bxs-cloud-download' ></i>
					  <span class="text">Download PDF</span>
				  </a>
			  </div>
  
			  <ul class="box-info">
				  <li>
					  <i class='bx bxs-dollar-circle' ></i>
					  <span class="text">
						  <h3 id="total_profit">$0</h3>
						  <p>Total Profit</p>
					  </span>
				  </li>
				  <li>
					  <i class='bx bxs-dollar-circle' ></i>
					  <span class="text">
						  <h3 id="total_income">$0</h3>
						  <p>Total Income</p>
					  </span>
				  </li>
				  <li>
					  <i class='bx bxs-dollar-circle' ></i>
					  <span class="text">
						  <h3 id="total_expense">$0</h3>
						  <p>Total Expense</p>
					  </span>
				  </li>
			  </ul>
  
  
			  <div class="table-data">
				  <div class="order">
					  <div class="head">
						  <h3>All Expense Report</h3>
						  <i class='bx bx-search' ></i>
						  <i class='bx bx-filter' ></i>
					  </div>
					  <div id="recent_activity" >
					
						


  
					  </div>
				  </div>
				  <div class="todo">
					  <div class="head">
						  <h3>Add Expense Details</h3>
						  <i class='bx bx-plus' ></i>
						  <i class='bx bx-filter' ></i>
						</div>  
			  <!-- <h1>frrom will be appen over herecheckout line no. 153 resiter.html</h1> -->

			  <!-- here expense form is present -->

					  <form id="salary-form">
					
						<label for="title">Title</label>
						<input type="text" id="title" name="title" /><br />

						<label for="income-option">Expense On</label>
						<select id="income-option" name="income-option">
						  <option value="Education">
							Education
						  </option>
						  <option
							value="Groceries"
						  >
							Groceries
						  </option>
						  <option
							value="Healthcare"
						  >
							Health
						  </option>
						  <option
							value="Subscriptions"
						  >
							Subscriptions
						  </option>
						  <option value="Clothing">
							Clothing
						  </option>
						  <option
							value="Travelling"
						  >
							Travelling
						  </option>
						  <option
							value="Other"
						  >
							Other
						  </option></select
						><br />
				
						<!-- <label for="title">Salary Type</label><br>
						<input type="text" id="title" name="title"><br> -->
				
						<label for="amount">Amount</label>
						<input type="number" id="amount" name="amount" /><br />
				
						<label for="date">Date</label>
						<input type="date" id="date" name="date" /><br />
				
						<label for="comments">Comment</label>
						<!-- <textarea id="comments" name="comments" rows="4" cols="50"></textarea -->
							<input type="text" id="comments" name="comments"><br>
						
				
						<input id="submitBtn" style="	background-color: #4bcb87;
						color: white;
						cursor: pointer;
						width: 150px;
						height: 40px;
						margin-left: 100px;
						border-radius: 50px;" class="submitBtn" type="submit" value="Submit" />
					  </form>
				  </div>
			  </div>
  
			  
		  
		  <!-- MAIN -->
	  </section>
  
	  
	  <!-- CONTENT -->
  
	  
  </body>
	<script>
		const switchMode = document.getElementById('switch-mode');

switchMode.addEventListener('change', function () {
	if(this.checked) {
		document.body.classList.add('dark');
	} else {
		document.body.classList.remove('dark');
	}
})



//expenses data
let formData = document.getElementById("salary-form");
let title = document.getElementById("title");
let amount = document.getElementById("amount");
let date = document.getElementById("date");
let category = document.getElementById("income-option");
let comments = document.getElementById("comments");
let AllIncome = document.getElementById("total_income");
let AllExpense = document.getElementById("total_expense");
let Profit =  document.getElementById("total_profit");

formData.addEventListener('submit', async(e)=>{
e.preventDefault();
// console.log("hjdsbhjf");


//sending the data


const res =  await fetch("https://bbuddybe.onrender.com/budget/adddata", {
    method: "POST",
    headers: {
	      "Content-Type": "application/json",
		  "authorization" : `Bearer ${JSON.parse(localStorage.getItem("token"))}`
    },
    body: JSON.stringify({
      title: title.value,
   
       type :"Expense",
	   category :category.value,
      amount: amount.value,
	  date: date.value,
      comment: comments.value
	   
    }),
  });
let data = await res.json()
console.log(data);


window.location.reload();




})


let datacontainer = document.getElementById("recent_activity")

//appending form data

window.onload = async()=>{
	let res = await fetch("https://bbuddybe.onrender.com/budget/allexpense" ,{
		headers :  {
			"authorization" : `Bearer ${JSON.parse(localStorage.getItem("token"))}`
		}

	})
	let formData = await res.json()
console.log(formData);

appendData(formData)


let res2 = await fetch("https://bbuddybe.onrender.com/budget/totalincome" ,{
		headers :  {
			"authorization" : `Bearer ${JSON.parse(localStorage.getItem("token"))}`
		}

	})
let totalIncome = await res2.json();
console.log(totalIncome)

AllIncome.innerText = "₹ "  + totalIncome.TotalIncome



let res3 = await fetch("https://bbuddybe.onrender.com/budget/totalexpense" ,{
		headers :  {
			"authorization" : `Bearer ${JSON.parse(localStorage.getItem("token"))}`
		}

	})
let totalExpense = await res3.json();
console.log(totalExpense)

AllExpense.innerText = "₹ "  + totalExpense.TotalExpense




let res4 = await fetch("https://bbuddybe.onrender.com/budget/totalprofit" ,{
		headers :  {
			"authorization" : `Bearer ${JSON.parse(localStorage.getItem("token"))}`
		}

	})
let totalProfit = await res4.json();
console.log(totalProfit)

Profit.innerText = "₹ "  + totalProfit.totalProfit



}

function appendData(data){

data.forEach(element => {
	// datacontainer
	let title = element.title;
	let category = element.category
	let date = element.date
	let amount = element.amount
	datacontainer.innerHTML += 	`
	<div id = "Datacard">
						<h3 id="titlee">Title:  ${title}</h3>
						
						<p id="categoryy">Category:  ${category}</p>
						
						<p id="datee">Date:  ${date.substring(0,10)}</p>
						<p id="amountt">Amount:  ₹ ${amount}</p>
						<button id="updateBtn">Update</button>
						<button onclick = "deleteRestaurant("${element._id}")"  id="${element._id}" class="deleteBtn">Delete</button>
						</div>
	`
// console.log(element._id)


});


}
let deleteBTN = document.querySelectorAll(".deleteBtn")
console.log(deleteBTN)

// function deleteData(id){
// 	console.log(id)


// }
const deleteRestaurant = (id) => {
console.log(id)
// fetch(`https://bbuddybe.onrender.com/budget/totalexpense/${id}`,{
// 	method : "DELETE",
// 	headers : {
// 		"Content-Type" : "application/json"
// 	}
// }).then((res)=>{
// 	console.log(res)
// })

//     axios({
//       url: `${process.env.REACT_APP_URL}/restaurants/${id}`,
//       method: "delete",
//     }).then(() => {
//       fetchAndUpdateData(page, sortOrder,filterby);
//     });
  };




	</script>
</html>